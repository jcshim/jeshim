# 작동테스트

from machine import UART, Pin
import time

# 핀 설정 (제공해주신 최신 배선 기준)
# GP6: RST, GP7: SET, GP8: TX, GP9: RX
rst_pin = Pin(6, Pin.OUT)
set_pin = Pin(7, Pin.OUT)

# 센서 활성화

```
set_pin.value(1)
rst_pin.value(1)
time.sleep(2) # 팬 가동 및 안정화 대기

# UART1 설정 (GP8: TX, GP9: RX)
uart = UART(1, baudrate=9600, tx=Pin(8), rx=Pin(9), timeout=1000)

print("PMS7003 Raw 데이터 수신 테스트 시작...")

try:
    while True:
        if uart.any() >= 32:
            raw = uart.read(32)
            # 16진수로 변환하여 출력
            hex_data = " ".join("{:02x}".format(b) for b in raw)
            print(f"Received ({len(raw)} bytes): {hex_data}")
            
            # 시작 바이트 검증
            if raw[0] == 0x42 and raw[1] == 0x4d:
                print("-> [OK] 시작 바이트(42 4d) 일치")
            else:
                print("-> [Error] 시작 바이트 불일치. 연결 확인 필요")
        else:
            print("데이터 기다리는 중...", end="\r")
        
        time.sleep(0.5)

except KeyboardInterrupt:
    print("\n테스트 중단")

```
